cabal-version:      3.4
-- The cabal-version field refers to the version of the .cabal specification,
-- and can be different from the cabal-install (the tool) version and the
-- Cabal (the library) version you are using. As such, the Cabal (the library)
-- version used must be equal or greater than the version stated in this field.
-- Starting from the specification version 2.2, the cabal-version field must be
-- the first thing in the cabal file.

-- Initial package description 'wasm-test-project' generated by
-- 'cabal init'. For further documentation, see:
--   http://haskell.org/cabal/users-guide/
--
-- The name of the package.
name:               wasm-test-project

-- The package version.
-- See the Haskell package versioning policy (PVP) for standards
-- guiding when and how versions should be incremented.
-- https://pvp.haskell.org
-- PVP summary:     +-+------- breaking API changes
--                  | | +----- non-breaking API additions
--                  | | | +--- code changes with no API change
version:            0.1.0.0

-- A short (one-line) description of the package.
-- synopsis:

-- A longer description of the package.
-- description:

-- The license under which the package is released.
license:            MIT

-- The file containing the license text.
license-file:       LICENSE

-- The package author(s).
author:             branko@branko

-- An email address to which users can send suggestions, bug reports, and patches.
maintainer:         branko@branko

-- A copyright notice.
-- copyright:
build-type:         Simple

-- Extra doc files to be distributed with the package, such as a CHANGELOG or a README.
extra-doc-files:    CHANGELOG.md

-- Extra source files to be distributed with the package, such as examples, or a tutorial module.
-- extra-source-files:

common warnings
    ghc-options: -Wall

library
    -- Import common warning flags.
    import:           warnings

    -- Modules exported by the library.
    exposed-modules:  Nostr.JSM
                      -- Nostr.Relay
                      Nostr.Request
                      Nostr.Response
                      Nostr.Relay
                      Nostr.Filter
                      Nostr.Kind
                      Nostr.Event
                      Nostr.Keys
                      Nostr.Profile
                      Nostr.WebSocket
                      Nostr.Network
                      MyCrypto
                      MyMain
                      ProfileLoader

    -- Modules included in this library but not exported.
    -- other-modules:

    -- LANGUAGE extensions used by modules in this package.
    -- other-extensions:

    -- Other library packages from which modules are imported.
    build-depends:    base ^>=4.20.0.0
                      , secp256k1-haskell
                      , effectful
                      , miso
                      , aeson
                      , jsaddle
                      , jsaddle-dom
                      , bytestring
                      , vector
                      , cryptohash-sha256
                      -- , base16-bytestring
                      ,base16
                    -- dependencies for the nostr part
                      , data-default
                      , text
                      , modern-uri
                      , time
                      , containers
                      , string-conversions
                      , datetime
                      , lens
                      , optics
                      , stm
    -- Directories containing source files.
    hs-source-dirs:   src

    -- Base language which the package is written in.
    default-language: Haskell2010

executable nostr-wasm
  hs-source-dirs: app 
  -- default-language: GHC2021
  main-is:
     App.hs
  -- other-modules:
  --    MyMain
  if arch(wasm32)
    ghc-options: -no-hs-main -optl-mexec-model=reactor "-optl-Wl,--export=hs_start"
  else 
    ghc-options: -main-is App.main 
  build-depends: 
    wasm-test-project
    , aeson
    , miso
    , containers
    , transformers
    , jsaddle
    , jsaddle-wasm
    , ghc-experimental
    , base
    , mtl
    , lens
    , optics
    -- , jsaddle-warp